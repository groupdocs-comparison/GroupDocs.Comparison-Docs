---
id: groupdocs-comparison-for-net-19-5-release-notes
url: comparison/net/groupdocs-comparison-for-net-19-5-release-notes
title: "Заметки о выпуске GroupDocs.Comparison для .NET 19.5"
weight: 7
description: ""
ключевые слова:
productName: GroupDocs.Comparison для .NET
hideChildren: False
---
{{< alert style="info" >}}Эта страница содержит примечания к выпуску GroupDocs.Comparison для .NET 19.5{{< /alert >}}

## Основные характеристики

Ниже приведен список наиболее заметных изменений в выпуске GroupDocs.Comparison для .NET 19.5:

* Реализован расчет изменений для диаграмм, слайдов и форматов PDF
* Реализован метод получения информации о документе
* Улучшена обработка исключений и ошибок во всех проектах для всех поддерживаемых форматов.
* Исправлена проблема с получением изображений для файлов HTML
* Исправлена проблема с обнаружением шрифтов
* Исправлено неверное отличие в PDF
* Улучшено обнаружение изменений в таблицах документов Word.

## Полный список проблем, охватывающих все изменения в этой версии

| Ключ | Резюме | Тип выпуска |
| --- | --- | --- |
| СРАВНЕНИЕ-1847 | Рассчитать правильные координаты изменений для слайдов | Особенность |
| СРАВНЕНИЕ-1849 | Рассчитать правильные координаты изменений для PDF | Особенность |
| СРАВНЕНИЕ-1852 | Рассчитать правильные координаты изменений для диаграмм | Особенность |
| СРАВНЕНИЕ-1895 | Реализовать метод получения информации о документе | Особенность |
| СРАВНЕНИЕ-1773 | Улучшения обработки ошибок для всех форматов | Улучшение |
| СРАВНЕНИЕ-1799 | Улучшение обнаружения изменений в таблицах в Word | Улучшение |
| СРАВНЕНИЕ-1808 | Сравнение не работает в Footnote | Ошибка |
| СРАВНЕНИЕ-1774 | Не удается получить изображения для файлов HTML | Ошибка |
| СРАВНЕНИЕ-1805 | Удаленные элементы в результатах сравнения не соответствуют ожидаемым | Ошибка |
| СРАВНЕНИЕ-1892 | Неправильная информация о различиях в PDF | Ошибка |
| СРАВНЕНИЕ-1899 | Html MarkDeletedInsertedContentГлубокая ошибка | Ошибка |
| СРАВНЕНИЕ-1903 | Проблема с лицензией в приложении GroupDocs.Comparison для .NET | Ошибка |
| СРАВНЕНИЕ-1906 | Исключение при обнаружении шрифта | Ошибка |
| СРАВНЕНИЕ-1909 | Исключение разделения слов | Ошибка |

## Публичный API и обратно несовместимые изменения

{{< alert style="info" >}}В этом разделе перечислены изменения общедоступного API, внесенные в GroupDocs.Comparison для .NET 19.5. Он включает в себя не только новые и устаревшие общедоступные методы, но и описание любых изменений в поведении за кулисами в GroupDocs.Comparison, которые могут повлиять на существующий код. Любое введенное поведение, которое можно рассматривать как регрессию и изменение существующего поведения, особенно важно и задокументировано здесь.{{< /alert >}}

1. **Расширенные свойства PageImage**
На данный момент класс PageImage был расширен за счет добавления двух общедоступных свойств *Width* и *Height*.
    














```csharp
Компаратор компаратор = новый компаратор();
     

















// получаем список страниц в виде картинок
Список<PageImage> sourceImages = Comparer.ConvertToImages (исходный путь);
// получаем размеры первой страницы
int h = sourceImages[0].Height;
int w = исходные изображения [0]. Ширина;
```
    














2. **Получение координат изменений**
    














Получение координат конкретных изменений в итоговом документе работает для документов **Слайды, PDF** и **Диаграммы**.
    














Для использования этой функции необходимо указать в свойстве *ComparisonSettings CalculateComponentCoordinates*
    














```csharp
Настройки ComparisonSetting = новый ComparisonSetting
{
...
ВычислитьКоординатыКомпонента = Истина;
...
}
```
    














Координаты изменений будут храниться в свойстве *Box* класса *ChangeInfo*.
    














```csharp
Список<ChangeInfo> изменения = новый список<ChangeInfo> (Результат.ПолучитьИзменения());
chages[0].Box // координаты первого изменения
```
    














Пример дальнейшего использования этой опции:
    














```csharp
Параметры сравнения Параметры сравнения = новые Параметры сравнения();
CompareSettings.StyleChangeDetection = true;
//эта настройка указывает, что мы хотим изменить координаты
compareSettings.CalculateComponentCoordinates = true;
сравнениеSettings.DetailLevel = DetailLevel.High;
строка sourcePath = "source.pdf";
строка targetPath = "target.pdf";
строка resultPath = "result.pdf;
Компаратор компаратор = новый компаратор();
Результат ICompareResult = Comparer.Compare (исходный путь, целевой путь, параметры сравнения);
результат.СохранитьДокумент(РезультатПуть);
     

















Список<PageImage> resultImages = comparer.ConvertToImages(resultPath);
Список<ChangeInfo> изменения = новый список<ChangeInfo> (Результат.ПолучитьИзменения());
     

















//ниже один из случаев, как мы могли бы использовать изменения координат.
//проходим по объекту страницы и рисуем прямоугольник в координатах изменений
foreach (изображение PageImage в resultImages)
{
Растровое изображение = новое растровое изображение (image.PageStream);
используя (Graphics Graphics = Graphics.FromImage (растровое изображение))
{
foreach (ChangeInfo changeInfo в изменениях)
{
// если что-то было вставлено, нарисуйте синий прямоугольник
если (changeInfo.Type == TypeChanged.Inserted)
Graphics.DrawRectangle (новый Pen (Color.Blue), changeInfo.Box.X, changeInfo.Box.Y, changeInfo.Box.Width, changeInfo.Box.Height);
//если что-то было удалено, нарисуйте красный прямоугольник
если (changeInfo.Type == TypeChanged.Deleted)
Graphics.DrawRectangle (новый Pen (Color.Red), changeInfo.Box.X, changeInfo.Box.Y, changeInfo.Box.Width, changeInfo.Box.Height);
// если что-то было изменено, рисуем зеленый прямоугольник
если (changeInfo.Type == TypeChanged.StyleChanged)
Graphics.DrawRectangle (новый Pen (Color.Green), changeInfo.Box.X, changeInfo.Box.Y, changeInfo.Box.Width, changeInfo.Box.Height);
}
}
bitmap.Save(savePath + @"/Result_Pages/result_" + image.PageNumber + ".png");
растровое изображение.Dispose();
}
```
    














3. **Новый класс DocumentInfo**
    














Добавлен новый класс DocumentInfo. Этот класс содержит следующие свойства:
    














NumberOfPages (только для чтения) - количество страниц документа
PagesData (только для чтения) - список классов PageInfo
    














Класс PageInfo содержит следующие свойства:
Ширина - ширина страницы
Высота - высота страницы
    














```csharp
Информер информер = новый Информер();
//получаем информацию о документе из filePath
DocumentInfo documentInfo = informer.GetDocumentInfo(filePath);
```

