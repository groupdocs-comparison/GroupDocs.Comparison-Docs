---
id: пример сравнения-как-использовать-ktor
url: comparison/java/how-to-use-ktor-comparison-sample
title: "Как использовать образец сравнения Ktor"
weight: 19
description: "В статье описывается пример сравнения GroupDocs, созданный с помощью Ktor Framework."
keywords: "Ktor Framework, сравнение документов, сравнение файлов с Kotlin, инструмент сравнения с Kotlin и Ktor Framework"
productName: GroupDocs.Comparison для Java
hideChildren: False
структурированные данные:
шоуОрганизация: True
заявление:
имя: Pdf, Word, API сравнения изображений
        description: "Продукт позволяет сравнивать файлы Pdf, Word и Image."
код продукта: сравнение
Платформа продукта: Java
как:
название: Как использовать Ktor Framework
        description: "Узнайте, как использовать Ktor Framework для сравнения документов, изображений и других файлов в проекте Java или Kotlin."
шаги:
- название: Какие технологии будут использоваться
текст: Узнайте, какие технологии необходимы и будут использоваться в приложении
- название: Общая структура проекта
текст: Очень важно сформировать основную структуру проекта приложения
- название: Точка входа или как запустить образец
текст: один или несколько способов запуска приложения
- название: Ключевые места внутри приложения
текст: Реализуйте общие функции внутри приложения, чтобы оно работало
---
Существует множество популярных веб-фреймворков, которые вы можете использовать с библиотекой сравнения GroupDocs. Одним из самых современных и мощных фреймворков Kotlin является Ktor. В этой статье описывается пример использования Ktor Framework вместе с современным и мощным [API GroupDocs.Comparison](https://products.groupdocs.com/comparison) для сравнения документов Word, Excel, PowerPoint, Pdf, фотографий и многого другого. Пример полностью бесплатен для использования и доступен [на GitHub] (https://github.com/groupdocs-comparison/GroupDocs.Comparison-for-Java/tree/68c3f01/Demos/Ktor)

### Какие технологии будут использоваться

1. Kotlin — современный язык программирования, который делает разработчиков счастливее. Полностью совместим с библиотеками Java.
2. Ktor — современная, бесплатная и интересная веб-инфраструктура с открытым исходным кодом.
3. Netty — встроен в Ktor-версию веб-сервера.
4. [GroupDocs.Comparison API](https://products.groupdocs.com/comparison/) — современная библиотека сравнения для Java, Kotlin и .NET
5. Koin — библиотека инъекций Smart Kotlin
6. Logback - Универсальная система логирования

### Общая структура проекта

* `config` — классы Kotlin для сопоставления конфигураций приложения и компаратора
* `di` — модули внедрения зависимостей Koin
* `manager` - абстрактный слой для широко используемых операций
* `model` - классы запроса/ответа Kotlin
* `modules` - сопоставления URL-адресов и контроллеры для обработки запросов
* `status` - обработчики исключений
* `usecase` - бизнес-логика

#### Дополнительные важные файлы

В источниках:

* `Application.kt` - точка входа приложения
* `Defaults.kt` - значения по умолчанию, которые будут использоваться, если они не настроены

В ресурсах:

* `application.conf` - конфигурация приложения
* `comparer.conf` - пример конфигурации
* `logback.xml` - конфигурация системы логирования

### Точка входа или как запустить пример

#### Использование IDE

Точка входа приложения находится в файле Application.kt. Существует основная функция, которую необходимо запустить, чтобы запустить приложение. Вы можете сделать это в своей любимой IDE.

#### Использование командной строки

Чтобы запустить приложение, откройте командную строку в каталоге образцов Ktor и выполните следующую команду.

<script src="https://gist.github.com/groupdocs-comparison-gists/6987202c524f6c430eae2669bad8c64b.js"></script>

Команда запустит приложение, используя оболочку gradle, которая находится в каталоге `gradle`. Откройте [http://localhost:8080/comparer](http://localhost:8080/comparison) в веб-браузере.

Вы можете легко создать архив для распространения. Для этого просто создайте приложение с помощью следующей команды

<script src="https://gist.github.com/groupdocs-comparison-gists/77581fd6decb81d87d7a7487f997de7a.js"></script>

После этого вы можете перейти в каталог `.\build\distributions\` и найти следующие файлы дистрибутива:

* сравнение-ktor-22.3.tar
* сравнение-ktor-22.3.zip

Внутри них есть два каталога: «lib» со всеми библиотеками приложений и «bin» со скриптами для запуска приложения.

### Ключевые места внутри приложения

#### Сопоставления и контроллеры

Пакет `mudules` содержит некоторое количество подпакетов. Каждый из них представляет собой отдельный запрос. Например, давайте рассмотрим подпакет `compare`.
В пакете два файла:
1. `CompareModule.kt` - содержит сопоставление URL-адресов, будет вызываться при отправке запроса на сравнение документов из браузера.

<script src="https://gist.github.com/groupdocs-comparison-gists/6c365c5e96514aad2d97c319e67540d5.js"></script>

Все, что делает класс: ловит запрос, извлекает параметры, вызывает контроллер и возвращает объект ответа
2. `CompareController.kt` - объединение результатов вариантов использования и параметров создает объект ответа.
Прежде всего, используя PathManager, он проверяет, что пути запросов находятся внутри разрешенных каталогов.

<script src="https://gist.github.com/groupdocs-comparison-gists/80121384a48c0bd18adf82471ec06158.js"></script>

Затем контроллер проверяет, поддерживаются ли запрошенные файлы приложением сравнения. Для этого используется специальный вариант использования, который называется `AreFilesSupportedUseCase`.

<script src="https://gist.github.com/groupdocs-comparison-gists/d967ad8ff4850452d20be766fc80e540.js"></script>

Следующим шагом является создание пути к файлу, в котором будет сохранен результирующий документ процесса сравнения.

<script src="https://gist.github.com/groupdocs-comparison-gists/e5fbb26f52bd2a20e6ba7e918761bc60.js"></script>

Временные файлы используются для минимизации использования оперативной памяти. Приложение легко изменить, чтобы оно не сохраняло файлы. Временный каталог можно указать в `comparer.conf`. По умолчанию используется системный временный каталог.

Теперь контроллер использует `CompareDocumentsUseCase` для сравнения исходного и целевого документов и сохранения файла результатов. Кроме того, вариант использования возвращает список изменений, которые позже будут установлены в объекте ответа.

<script src="https://gist.github.com/groupdocs-comparison-gists/8c38027c876bcdb257a410ed9ed295b6.js"></script>

Следующий вариант использования, который называется «RetrieveLocalFilePagesStreamUseCase», используется для получения входного потока для каждой страницы результирующего документа.

<script src="https://gist.github.com/groupdocs-comparison-gists/3a9ae7912f345b02e45a2469287ffed6.js"></script>

И последний шаг — сопоставить объекты групповой документации `ChangeInfo` с моделями ответов, которые будут отправлены в результате.

#### Что такое варианты использования и как их использовать

В общем, вариант использования — это единственное, что можно сделать. Обычно он содержит бизнес-логику, имеет только одну цель и легко тестируется. Все варианты использования в проекте настроены на создание Koin. Некоторые варианты использования имеют параметры конструктора, которые вводятся, когда Koin создает экземпляр варианта использования.
В качестве примера рассмотрим `CompareDocumentsUseCase`.

В сценарии использования переопределен оператор `invoke`, так что его можно вызывать, используя его объект как функцию. Единственная цель варианта использования — сравнить исходный и целевой документы и записать результат в предоставленный выходной поток.

<script src="https://gist.github.com/groupdocs-comparison-gists/a73539b2fdb66f8cde9495beb47d5fc5.js"></script>

В качестве параметров принимает пути исходного и целевого документов и выходной поток, в котором должен быть сохранен результат. Необязательными параметрами являются пароли для каждого документа.

Для сравнения документов мы используем мощную и современную библиотеку [GroupDocs.Comparison for Java/Kotlin](https://products.groupdocs.com/comparison/java/). С библиотекой процесс сравнения очень прост.

Первым шагом является создание объекта класса `Comparer`. Параметры загрузки используются для предоставления пароля для документа. Кроме того, с помощью опций вы можете настроить Comparer для использования первого параметра не в качестве пути к исходному документу (также доступны потоки), а для использования его в качестве исходного текста для процесса сравнения. Кроме того, есть возможность настроить каталоги с определенными шрифтами. Comparer реализует интерфейс Java `Closeable`, поэтому очень легко освободить используемую память.

<script src="https://gist.github.com/groupdocs-comparison-gists/cded4b9f8a4f1fd1ec4ae1de61c3b15a.js"></script>

Внутри блока «использовать» мы вызываем метод компаратора «добавить», чтобы добавить второй документ или текст для сравнения. Метод принимает тот же параметр `LoadOptions`. Кроме того, [API GroupDocs.Comparison](https://products.groupdocs.com/comparison/java/) поддерживает сравнение нескольких документов, поэтому вы можете добавить более одного целевого документа.

<script src="https://gist.github.com/groupdocs-comparison-gists/180ae9b27854c4b11dde7854e6ead725.js"></script>

Последнее, что нужно сделать, это вызвать метод `compare`, который начнет процесс сравнения. Как видите, метод принимает объект `CompareOptions` в качестве второго аргумента. Здесь используются всего несколько вариантов. Он настроен для отображения содержимого, которое было удалено в целевом документе, для распознавания и обработки изменений стилей и предоставления координаты каждого изменения в результирующем документе. Вариантов гораздо больше. Например, вы можете включить создание сводной страницы, изменить уровень чувствительности сравнения, включить/отключить каждый тип изменений, настроить его стиль в результирующем документе и так далее. Дополнительные параметры вы можете найти [в документации](/comparison/java/getting-started/).
В конце блока «применить» мы используем метод «comparer.getChanges()», чтобы получить список изменений.

#### Внедрение зависимости

Еще одна важная вещь в приложении — это объект `ModulesInjection`. Он используется для предоставления Koin информации о классах и интерфейсах, которые он должен создать или внедрить. Здесь есть контроллеры, юзкейсы и менеджеры. Добавляя любой новый класс, который должен быть внедрен Koin, очень важно указать его здесь в одном из модулей.

<script src="https://gist.github.com/groupdocs-comparison-gists/0754c1a4729f7b0f0e6d4828049d6a48.js"></script>

### Получите бесплатную лицензию API

Многие настройки сравнения, например, генерация итоговой страницы, чувствительность сравнения и т. д., доступны только при наличии лицензии. Вы можете получить [бесплатную временную лицензию](https://purchase.groupdocs.com/temporary-license), чтобы использовать API без оценочных ограничений.

### Вывод

В статье описан пример [GroupDocs.Comparison](https://products.groupdocs.com/comparison/java/), реализованный с помощью веб-фреймворка Ktor. На нашей [странице GitHub] (https://github.com/groupdocs-comparison/GroupDocs.Comparison-for-Java) есть еще примеры использования GroupDocs.Comparison для Java/Kotlin. Они полностью бесплатны и открыты для использования в качестве ядра вашего собственного приложения для сравнения фотографий, Excel, Word, файлов кода, презентаций PowerPoint и многого другого [поддерживаемые форматы файлов](/comparison/java/supported-document-formats/) .

Дополнительные сведения, варианты и примеры можно найти в [документации](/comparison/java/getting-started/) и репозитории [GitHub](https://github.com/groupdocs-comparison). Свяжитесь с нами [на форуме] (https://forum.groupdocs.com/) для решения ваших вопросов.

### Смотрите также

* Как [сравнить документы](/comparison/java/how-to-compare-documents-in-the-easiest-way) самым простым способом
* Как [сравнить файлы](/comparison/java/how-to-compare-files-in-java-or-kotlin) в Java или Kotlin
* Как [сравнивать изображения](/comparison/java/how-to-compare-images-using-java-or-kotlin) с помощью Java или Kotlin
* Как [сравнить два или более файлов](/comparison/java/how-to-compare-two-or-more-files-in-java-or-kotlin) в Java или Kotlin
* Как [использовать Dropbox API](/comparison/java/how-to-use-dropbox-api-as-files-source-for-comparison-api) в качестве источника файлов для Comparison API
* Как [сравнить текст, Word или PDF](/comparison/java/how-to-compare-text-word-pdf-in-java-or-kotlin) в Java или Kotlin

