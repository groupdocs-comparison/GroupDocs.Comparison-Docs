---
id: groupdocs-comparison-for-java-19-10-release-notes
url: comparison/java/groupdocs-comparison-for-java-19-10-release-notes
title: "Заметки о выпуске GroupDocs.Comparison для Java 19.10"
weight: 1
description: ""
ключевые слова:
productName: GroupDocs.Comparison для Java
hideChildren: False
---
{{< alert style="info" >}}Эта страница содержит примечания к выпуску GroupDocs.Comparsion для Java 19.10{{< /alert >}}

## Основные характеристики

Ниже приведен список исправленных ошибок в этом выпуске GroupDocs.Comparsion для Java. Наиболее заметными являются:

* Реализована возможность конвертировать документы разных форматов в изображения
* Исправлена проблема с элементами SuperScript и SubScript в документах Word.
* Исправлены настройки стиля для GroupDocs.Comparison.Html
* Исправлена проблема со сравнением файлов PDF большого размера (другие случаи)
* Исправлено не работающее сравнение элемента EndNote в Words
* Реализован расчет изменений для диаграмм, слайдов и форматов PDF
* Реализован метод получения информации о документе
* Улучшена обработка исключений и ошибок во всех проектах для всех поддерживаемых форматов.
* Исправлена проблема с получением изображений для файлов HTML
* Исправлена проблема с обнаружением шрифтов
* Исправлено неверное отличие в PDF
* Улучшено обнаружение изменений в таблицах документов Word.
* Исправлена проблема с переносом разделов на новую страницу
* Исправлены опечатки в справке по API
* Реализован параметр чувствительности
* Реализован расчет координат изменений для документов Word
* Исправлено наложение содержимого в результирующих документах PDF.
* Исправлена проблема с переносом разделов на новую страницу
* Интегрированная система выставления счетов на основе кредита с использованием последней версии Metered
* Обновлено пространство имён на более логичное и удобное (некоторые пространства имён были переименованы)

## Полный список проблем, охватывающих все изменения в этой версии

| Ключ | Резюме | Тип выпуска |
| --- | --- | --- |
| СРАВНЕНИЕ-1836 | Сохранение документов в виде изображений для Word | Особенность |
| СРАВНЕНИЕ-1837 | Сохранить документы как изображения для Cells | Особенность |
| СРАВНЕНИЕ-1838 | Сохранить документы как изображения для слайдов | Особенность |
| СРАВНЕНИЕ-1839 | Сохранение документов в виде изображений для PDF | Особенность |
| СРАВНЕНИЕ-1840 | Сохранение документов в виде изображений для HTML | Особенность |
| СРАВНЕНИЕ-1841 | Сохранить документы как изображения для электронной почты | Особенность |
| СРАВНЕНИЕ-1842 | Сохранить документы как изображения для Note | Особенность |
| СРАВНЕНИЕ-1843 | Сохранить документы как изображения для текста | Особенность |
| СРАВНЕНИЕ-1844 | Сохранить документы как изображения для диаграмм | Особенность |
| СРАВНЕНИЕ-1847 | Рассчитать правильные координаты изменений для слайдов | Особенность |
| СРАВНЕНИЕ-1849 | Рассчитать правильные координаты изменений для PDF | Особенность |
| СРАВНЕНИЕ-1852 | Рассчитать правильные координаты изменений для диаграмм | Особенность |
| СРАВНЕНИЕ-1895 | Реализовать метод получения информации о документе | Особенность |
| СРАВНЕНИЕ-1773 | Улучшения обработки ошибок для всех форматов | Улучшение |
| СРАВНЕНИЕ-1799 | Улучшение обнаружения изменений в таблицах в Word | Улучшение |
| СРАВНЕНИЕ-1846 | Рассчитать правильные координаты изменений для Words | Улучшение |
| СРАВНЕНИЕ-1929 | Реализовать параметр чувствительности | Улучшение |
| СРАВНЕНИЕ-1901 | Интеграция последней версии Dynabic.Metered в продукты | Улучшение |
| СРАВНЕНИЕ-1815 | Игнорировать комментарии (в основном для файлов с кодом). | Улучшение |
| СРАВНЕНИЕ-1816 | Игнорировать пробелы - Все, Ведущий, Конечный, Изменения в сумме | Улучшение |
| СРАВНЕНИЕ-1813 | Игнорировать регистр — игнорировать различия в регистре символов. | Улучшение |
| СРАВНЕНИЕ-1931 | Рефакторинг пространств имен GroupDocs.Comparison | Улучшение |
| СРАВНЕНИЕ-1806 | Проблема с надстрочным и подстрочным текстом | Ошибка |
| СРАВНЕНИЕ-1802 | Настройки StyleSettings не работают для html | Ошибка |
| СРАВНЕНИЕ-1803 | Проблема при сравнении файлов PDF большого размера (другие случаи) | Ошибка |
| СРАВНЕНИЕ-1804 | Сравнение EndNote не работает | Ошибка |
| СРАВНЕНИЕ-1808 | Сравнение не работает в Footnote | Ошибка |
| СРАВНЕНИЕ-1772 | Сравнение PDF имеет перекрывающийся и искаженный вывод | Ошибка |
| СРАВНЕНИЕ-1774 | Не удается получить изображения для файлов HTML | Ошибка |
| СРАВНЕНИЕ-1805 | Удаленные элементы в результатах сравнения не соответствуют ожидаемым | Ошибка |
| СРАВНЕНИЕ-1892 | Неправильная информация о различиях в PDF | Ошибка |
| СРАВНЕНИЕ-1899 | Html MarkDeletedInsertedContentГлубокая ошибка | Ошибка |
| СРАВНЕНИЕ-1906 | Исключение при обнаружении шрифта | Ошибка |
| СРАВНЕНИЕ-1909 | Исключение разделения слов | Ошибка |
| СРАВНЕНИЕ-1927 | Объединенный документ, а затем сравнение документов не удалось | Ошибка |
| СРАВНЕНИЕ-1891 | Текст накладывался на другой текст или изображения | Ошибка |
| СРАВНЕНИЕ-1930 | Дублирование изображений в файле результатов в формате PDF | Ошибка |
| СРАВНЕНИЕ-1772 | Сравнение PDF имеет перекрывающийся и искаженный вывод | Ошибка |
| СРАВНЕНИЕ-374 | Многопоточное сравнение возвращает null | Ошибка |

## Публичный API и обратно несовместимые изменения

{{< alert style="info" >}}В этом разделе перечислены изменения общедоступного API, внесенные в GroupDocs.Comparison для Java 19.10. Он включает в себя не только новые и устаревшие общедоступные методы, но и описание любых изменений в поведении за кулисами в GroupDocs.Comparison, которые могут повлиять на существующий код. Любое введенное поведение, которое можно рассматривать как регрессию и изменение существующего поведения, особенно важно и задокументировано здесь.{{< /alert >}}

1. **Расширенные свойства PageImage**
На данный момент класс PageImage был расширен за счет добавления двух общедоступных свойств *Width* и *Height*.
    





























```java
Компаратор компаратор = новый компаратор();
// получаем список страниц в виде картинок
Список<PageImage> sourceImages = Comparer.convertToImages (исходный путь);
// получаем размеры первой страницы
int height = sourceImages.get(0).getHeight();
целая ширина = sourceImages.get(0).getWidth();
```
    





























2. **Получение координат изменений**
    





























Получение координат конкретных изменений в итоговом документе работает для документов **Слайды, PDF** и **Диаграммы, Word**.
    





























Для использования этой функции необходимо указать в свойстве *ComparisonSettings CalculateComponentCoordinates*
    





























```java
Настройки ComparisonSetting = новый ComparisonSetting
...
settings.setCalculateComponentCoordinates(true);
...
```
    





























Координаты изменений будут храниться в свойстве *Box* класса *ChangeInfo*.
    





























```java
Компаратор компаратор = новый компаратор();
// Настройки
Параметры сравнения Параметры сравнения = новые Параметры сравнения();
compareSettings.setCalculateComponentCoordinates(true);
// Сравнить документы
ICompareResult compareResult = comparer.compare (исходный путь, целевое имя, параметры сравнения);
// Получение размеров первого изменения
ChangeInfo[] changes = compareResult.getChanges();
// Координаты первого изменения
окончательный прямоугольник прямоугольника = changes[0].getBox();
```
    





























Пример дальнейшего использования этой опции:
    





























```java
Параметры сравнения Параметры сравнения = новые Параметры сравнения();
сравнениеSettings.setStyleChangeDetection(true);
//эта настройка указывает, что мы хотим изменить координаты
compareSettings.setCalculateComponentCoordinates(true);
сравнениеSettings.setDetailLevel(DetailLevel.High);
     









































Компаратор компаратор = новый компаратор();
Результат ICompareResult = comparer.compare (исходный путь, целевой путь, параметры сравнения);
результат.saveDocument(resultPath);
     









































     









































Список<PageImage> resultImages = comparer.convertToImages(resultPath);
окончательные изменения ChangeInfo[] = result.getChanges();
     









































     









































// Ниже один из случаев, как мы могли бы использовать координаты изменений.
// Проходим по объекту страницы и рисуем прямоугольник в координатах изменений
для (PageImage pageImage : resultImages) {
окончательный InputStream pageStream = pageImage.getPageStream();
окончательное BufferedImage bufferedImage = ImageIO.read(pageStream);
окончательная графика Graphics = bufferedImage.getGraphics();
for (ChangeInfo changeInfo : изменения) {
окончательный прямоугольник Rectangle = changeInfo.getBox();
// если что-то было вставлено, нарисуйте синий прямоугольник
если (changeInfo.getType() == TypeChanged.Inserted) {
графика.setColor(Цвет.СИНИЙ);
Graphics.drawRect((int) прямоугольник.getX(), (int) прямоугольник.getY(), (int) прямоугольник.getWidth(), (int) прямоугольник.getHeight());
}
//если что-то было удалено, нарисуйте красный прямоугольник
если (changeInfo.getType() == TypeChanged.Deleted) {
     









































графика.setColor(Цвет.КРАСНЫЙ);
Graphics.drawRect((int) прямоугольник.getX(), (int) прямоугольник.getY(), (int) прямоугольник.getWidth(), (int) прямоугольник.getHeight());
}
// если что-то было изменено, рисуем зеленый прямоугольник
если (changeInfo.getType() == TypeChanged.StyleChanged) {
графика.setColor(Цвет.ЗЕЛЕНЫЙ);
Graphics.drawRect((int) прямоугольник.getX(), (int) прямоугольник.getY(), (int) прямоугольник.getWidth(), (int) прямоугольник.getHeight());
}
}
ImageIO.write(bufferedImage, "png", новый файл(resultPath.replace("result", "result_" + pageImage.getPageNumber()) + ".png"));
графика.расположить();
pageStream.close();
}
```
    





























3. **Получение графического представления страниц документа**
    





























```java
Компаратор компаратор = новый компаратор();
Параметры сравнения Параметры сравнения = новые Параметры сравнения();
сравнениеSettings.setStyleChangeDetection(true);
     









































// Сравнить документ
Результат ICompareResult = comparer.compare (исходный путь, целевой путь, параметры сравнения);
результат.saveDocument(resultPath);
     









































// Получить список страниц
Список<PageImage> resultImages = comparer.convertToImages(resultPath);
     









































// Сохраняем их как растровое изображение в отдельную папку
для (PageImage pageImage : resultImages) {
окончательный InputStream pageStream = pageImage.getPageStream();
     









































Assert.assertNotNull(pageStream);
     









































окончательное BufferedImage bufferedImage = ImageIO.read(pageStream);
ImageIO.write(bufferedImage, "png", новый файл(resultPath.replace(resultName, "result_" + pageImage.getPageNumber()) + ".png"));
}
```
    





























4. **Новый класс DocumentInfo**
    





























Добавлен новый класс *DocumentInfo*. Этот класс содержит следующие свойства
    





























*NumberOfPages* (только для чтения) - количество страниц документа
*PagesData* (только для чтения) - список классов *PageInfo*,
    





























Класс *PageInfo* содержит следующие свойства:
Ширина - ширина страницы
Высота - высота страницы
    





























```java
Информер информер = новый Информер();
// Получить информацию о документе из filePath
DocumentInfo documentInfo = informer.getDocumentInfo(sourcePath);
```
    





























5. **Настройка уровня детализации сравнения**
    





























1. Если мы установим *DetailLevel = Middle*, мы не будем добавлять комментарий в некоторых форматах документа (Words, Slides, Cells), если элемент был добавлен\\удален\\изменен
        












































2. Если мы установим *DetailLevel = Middle*, мы не будем делать сравнение без учета регистра. т.е. М = м.
        












































3. Добавлено свойство чувствительности. Эта опция определяет ограничение в процентах, когда элемент определяется как удаленный или вставленный.
        












































    





























Минимальное значение - 0, процесс сравнения не происходит ни при какой длине последовательностей двух сравниваемых объектов.
    





























Значение по умолчанию - 75, сравнение происходит, когда процент удаленных или вставленных элементов по отношению ко всем элементам не превышает 75%.
    





























Максимальное значение - 100, сравнение происходит при любой длине общей подпоследовательности двух сравниваемых объектов.
    





























**Например, у нас есть два слова**
    





























```java
1) один источник
     









































2) две цели
```
    





























У этих двух слов очень маленькая общая подпоследовательность. Поэтому при сравнении их с точностью 70% она не учитывается и мы получаем полностью удаленное и вставленное слово:
    





























```java
(twoTarget)[oneSource]
```
    





























Но со 100% точностью мы учитываем эту подпоследовательность, несмотря на то, что она состоит из двух букв
    





























```java
(tw)o[n](Targ)e[Source](t)
```
    





























Фрагмент кода:
    





























```java
Параметры сравнения Параметры сравнения = новые Параметры сравнения();
compareSettings.setSensitivityOfComparison(100);
Сравнить компаратор = новый компаратор();
Результат ICompareResult = compare.compare (исходный путь, целевой путь, параметры сравнения);
```

